(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();const l=[{id:1,name:"FASE 1: CINTUR√ÉO DE ASTEROIDES",locked:!1,levels:[{id:1,description:"Paciente apresenta palidez cut√¢neo-mucosa e fadiga. Qual o valor de Hemoglobina (Hb) que define anemia em mulheres adultas n√£o gestantes?",data:{Satura√ß√£o:"98%",FC:"88 bpm"},options:[{id:"a",text:"Hb < 13.5 g/dL",correct:!1},{id:"b",text:"Hb < 12.0 g/dL",correct:!0},{id:"c",text:"Hb < 11.0 g/dL",correct:!1},{id:"d",text:"Hb < 10.0 g/dL",correct:!1}],successMessage:"Correto! Hb < 12.0 g/dL define anemia em mulheres.",failMessage:"Incorreto. O valor de corte √© 12.0 g/dL."},{id:2,description:"Qual √© a causa mais comum de anemia no mundo, caracterizada por microcitose e hipocromia?",data:{VCM:"70 fL",HCM:"22 pg"},options:[{id:"a",text:"Anemia Perniciosa",correct:!1},{id:"b",text:"Anemia Apl√°stica",correct:!1},{id:"c",text:"Anemia Ferropriva",correct:!0},{id:"d",text:"Anemia Falciforme",correct:!1}],successMessage:"Exato! A defici√™ncia de ferro √© a causa mais comum.",failMessage:"Errado. Microcitose sugere falta de ferro."},{id:3,description:"Para melhorar a absor√ß√£o de sulfato ferroso oral, qual orienta√ß√£o de enfermagem √© correta?",data:{Prescri√ß√£o:"Sulfato Ferroso 40mg"},options:[{id:"a",text:"Tomar com leite ou iogurte",correct:!1},{id:"b",text:"Tomar com anti√°cidos",correct:!1},{id:"c",text:"Tomar logo ap√≥s o almo√ßo",correct:!1},{id:"d",text:"Tomar com suco de laranja (Vitamina C)",correct:!0}],successMessage:"Perfeito! O ambiente √°cido favorece a absor√ß√£o.",failMessage:"N√£o. C√°lcio e anti√°cidos diminuem a absor√ß√£o."},{id:4,description:"A Anemia Perniciosa √© causada pela defici√™ncia de qual vitamina?",data:{Sintomas:"Parestesias, Glossite"},options:[{id:"a",text:"Vitamina B12 (Cobalamina)",correct:!0},{id:"b",text:"Vitamina B9 (√Åcido F√≥lico)",correct:!1},{id:"c",text:"Vitamina C",correct:!1},{id:"d",text:"Vitamina D",correct:!1}],successMessage:"Correto! Falta de Fator Intr√≠nseco impede absor√ß√£o de B12.",failMessage:"Incorreto. √â defici√™ncia de B12."},{id:5,description:"Na administra√ß√£o intramuscular de ferro (Noripurum), qual t√©cnica deve ser utilizada para evitar manchas na pele?",data:{Via:"Intramuscular Profunda"},options:[{id:"a",text:"T√©cnica em Z (Z-track)",correct:!0},{id:"b",text:"Prega cut√¢nea simples",correct:!1},{id:"c",text:"Massagem vigorosa ap√≥s aplica√ß√£o",correct:!1},{id:"d",text:"Aplica√ß√£o no deltoide",correct:!1}],successMessage:"Excelente! A t√©cnica em Z evita o refluxo do medicamento.",failMessage:"Errado. Deve-se usar a t√©cnica em Z no gl√∫teo."}]},{id:2,name:"FASE 2: NEBULOSA ESCURA",locked:!0,levels:[]}];class u{constructor(e,t,s){this.canvas=document.getElementById(e),this.ctx=this.canvas.getContext("2d"),this.onObstacleEncountered=t,this.onGameOver=s,this.width=window.innerWidth,this.height=window.innerHeight,this.canvas.width=this.width,this.canvas.height=this.height,this.ship={x:100,y:this.height/2,size:30,speed:5,visible:!0},this.asteroids=[],this.stars=[],this.lasers=[],this.particles=[],this.gameActive=!1,this.isPaused=!1,this.lastTime=0,this.spawnTimer=0,this.obstaclePending=!1,this.isCrashing=!1,this.onObstacleDestroyed=null,this.initStars(),window.addEventListener("resize",()=>this.resize())}resize(){this.width=window.innerWidth,this.height=window.innerHeight,this.canvas.width=this.width,this.canvas.height=this.height,this.initStars()}initStars(){this.stars=[];for(let e=0;e<150;e++)this.stars.push({x:Math.random()*this.width,y:Math.random()*this.height,size:Math.random()*2,speed:Math.random()*3+.5})}start(){this.gameActive=!0,this.isPaused=!1,this.obstaclePending=!1,this.isCrashing=!1,this.asteroids=[],this.lasers=[],this.particles=[],this.ship.visible=!0,this.lastTime=performance.now(),this.loop(this.lastTime)}spawnObstacle(){this.asteroids=this.asteroids.filter(e=>!e.active),!this.obstaclePending&&(this.asteroids.push({x:this.width+50,y:this.height/2,size:60,hp:1,active:!0,doomed:!1}),this.obstaclePending=!0,this.isCrashing=!1)}destroyCurrentObstacle(e){this.isPaused=!1;const t=this.asteroids.find(s=>s.active);this.lasers.push({x:this.ship.x+this.ship.size,y:this.ship.y,speed:40,active:!0}),t?(t.doomed=!0,this.onObstacleDestroyed=e):e&&setTimeout(e,500)}triggerImpact(){this.isPaused=!1,this.obstaclePending=!1,this.isCrashing=!0}destroyShip(){this.gameActive&&(this.isPaused=!1,this.createExplosion(this.ship.x,this.ship.y,"#ff0000",80),this.createExplosion(this.ship.x,this.ship.y,"#ffff00",40),this.ship.visible=!1,this.gameActive=!1,setTimeout(()=>{this.onGameOver&&this.onGameOver()},2500))}createExplosion(e,t,s,i){this.particles.push({type:"shockwave",x:e,y:t,size:5,grow:15,alpha:1,color:s});for(let a=0;a<i;a++){const n=Math.random()*Math.PI*2,r=Math.random()*15+5;this.particles.push({type:"debris",x:e,y:t,vx:Math.cos(n)*r,vy:Math.sin(n)*r,life:1,decay:Math.random()*.03+.01,color:s,size:Math.random()*4+2})}}update(e){this.isPaused||(this.stars.forEach(t=>{t.x-=t.speed,t.x<0&&(t.x=this.width)}),this.asteroids.forEach(t=>{if(!t.active)return;let s=5;if(this.isCrashing&&(s=25),t.x-=s,!this.isCrashing&&t.x<this.width-300&&this.obstaclePending&&(this.isPaused=!0,this.obstaclePending=!1,this.onObstacleEncountered()),this.ship.visible){const i=t.x-this.ship.x,a=t.y-this.ship.y;Math.sqrt(i*i+a*a)<(t.size+this.ship.size)*.8&&this.destroyShip()}}),this.lasers.forEach(t=>{t.active&&(t.x+=t.speed,t.x>this.width&&(t.active=!1),this.asteroids.forEach(s=>{if(s.active&&s.doomed){const i=t.x-s.x,a=t.y-s.y;Math.sqrt(i*i+a*a)<s.size+20&&(s.active=!1,t.active=!1,this.createExplosion(s.x,s.y,"#ffaa00",40),this.createExplosion(s.x,s.y,"#ffffff",20),this.onObstacleDestroyed&&setTimeout(()=>{this.onObstacleDestroyed(),this.onObstacleDestroyed=null},1e3))}}))}),this.particles.forEach(t=>{t.type==="shockwave"?(t.size+=t.grow,t.alpha-=.05):(t.x+=t.vx,t.y+=t.vy,t.life-=t.decay,t.vx*=.95,t.vy*=.95)}),this.particles=this.particles.filter(t=>t.type==="shockwave"?t.alpha>0:t.life>0))}draw(){this.ctx.fillStyle="#000000",this.ctx.fillRect(0,0,this.width,this.height),this.ctx.fillStyle="#ffffff",this.stars.forEach(e=>{this.ctx.beginPath(),this.ctx.arc(e.x,e.y,e.size,0,Math.PI*2),this.ctx.fill()}),this.ship.visible&&(this.ctx.save(),this.ctx.translate(this.ship.x,this.ship.y),this.ctx.fillStyle="#00ff00",this.ctx.beginPath(),this.ctx.moveTo(20,0),this.ctx.lineTo(-15,10),this.ctx.lineTo(-15,-10),this.ctx.fill(),this.ctx.fillStyle=`rgba(0, 255, 255, ${Math.random()})`,this.ctx.beginPath(),this.ctx.moveTo(-15,0),this.ctx.lineTo(-30,5),this.ctx.lineTo(-30,-5),this.ctx.fill(),this.ctx.restore()),this.asteroids.forEach(e=>{e.active&&(this.ctx.fillStyle="#888888",this.ctx.beginPath(),this.ctx.arc(e.x,e.y,e.size,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="#666666",this.ctx.beginPath(),this.ctx.arc(e.x-10,e.y-10,e.size/3,0,Math.PI*2),this.ctx.fill())}),this.ctx.fillStyle="#00ffff",this.ctx.shadowBlur=10,this.ctx.shadowColor="#00ffff",this.lasers.forEach(e=>{e.active&&this.ctx.fillRect(e.x,e.y-3,40,6)}),this.ctx.shadowBlur=0,this.particles.forEach(e=>{e.type==="shockwave"?(this.ctx.strokeStyle=e.color,this.ctx.lineWidth=3,this.ctx.globalAlpha=e.alpha,this.ctx.beginPath(),this.ctx.arc(e.x,e.y,e.size,0,Math.PI*2),this.ctx.stroke()):(this.ctx.fillStyle=e.color,this.ctx.globalAlpha=e.life,this.ctx.beginPath(),this.ctx.arc(e.x,e.y,e.size,0,Math.PI*2),this.ctx.fill()),this.ctx.globalAlpha=1})}loop(e){const t=e-this.lastTime;this.lastTime=e,this.update(t),this.draw(),(this.gameActive||this.particles.length>0)&&requestAnimationFrame(s=>this.loop(s))}resume(){this.isPaused=!1,this.lastTime=performance.now()}}class f{constructor(){this.currentLevelIndex=0,this.score=0,this.mistakes=0,this.gameActive=!1,this.ui={app:document.getElementById("app"),container:document.getElementById("game-container"),loading:document.getElementById("loading-screen"),hud:document.getElementById("hud"),questionPanel:document.getElementById("question-panel")},this.arcade=null,this.phases=l,this.unlockedPhases=[1],this.currentPhase=null}init(){setTimeout(()=>{this.ui.loading.classList.add("hidden"),this.renderStartScreen()},1500)}renderStartScreen(){this.ui.container.innerHTML=`
      <div class="start-screen">
        <h1 class="glitch" data-text="PROTOCOLO VERMELHO">PROTOCOLO<br>VERMELHO</h1>
        <p class="subtitle">ARCADE EDITION</p>
        
        <div class="instructions">
          <p>MISSION: PILOT "HEMO-1"</p>
          <p>TARGET: DESTROY ANEMIA OBSTACLES</p>
          <p>WARNING: ONE HIT KILLS</p>
        </div>

        <div style="margin-bottom: 20px; color: var(--neon-yellow); font-size: 12px;">CREDIT 01</div>
        <button id="start-btn" class="btn pulse">INSERT COIN / START</button>
      </div>
    `,document.getElementById("start-btn").addEventListener("click",()=>{this.showLevelSelection()})}showLevelSelection(){this.ui.container.innerHTML=`
      <div class="level-selection-modal">
        <h2 style="color: var(--neon-blue); text-shadow: 0 0 10px var(--neon-blue);">SELECT MISSION</h2>
        <div class="level-grid">
          ${this.phases.map(e=>{const t=!this.unlockedPhases.includes(e.id);return`
              <div class="level-card ${t?"locked":""}" data-id="${e.id}">
                ${t?'<div class="lock-icon">üîí</div>':""}
                <h3>${e.name}</h3>
                <p>${t?"LOCKED":`${e.levels.length} QUESTIONS`}</p>
              </div>
            `}).join("")}
        </div>
        <button id="back-btn" class="btn back-btn">BACK</button>
      </div>
    `,document.querySelectorAll(".level-card").forEach(e=>{e.addEventListener("click",()=>{const t=parseInt(e.dataset.id);this.unlockedPhases.includes(t)&&this.startGame(t)})}),document.getElementById("back-btn").addEventListener("click",()=>{this.renderStartScreen()})}startGame(e){this.currentPhase=this.phases.find(t=>t.id===e),this.currentLevelIndex=0,this.score=0,this.mistakes=0,this.gameActive=!0,this.ui.container.innerHTML=`
      <canvas id="game-canvas"></canvas>
      <div id="hud" class="hud">
        <div class="score">SCORE: <span id="score-val">0</span></div>
        <div style="font-size: 12px; margin-top: 5px; color: var(--neon-blue);">${this.currentPhase.name}</div>
      </div>
      <div id="question-panel" class="question-panel hidden">
        <!-- Question injected here -->
      </div>
    `,this.arcade=new u("game-canvas",()=>this.showQuestion(),()=>this.showEndScreen(!1)),this.arcade.start(),setTimeout(()=>this.arcade.spawnObstacle(),2e3)}showQuestion(){const e=this.currentPhase.levels[this.currentLevelIndex];if(!e){this.showEndScreen(!0);return}const t=document.getElementById("question-panel");t.innerHTML=`
      <div class="panel-content">
        <h2>ALERTA DE COLIS√ÉO!</h2>
        <p class="description">${e.description}</p>
        ${this.renderLevelData(e)}
        <div class="options-grid">
          ${e.options.map(s=>`
            <button class="option-btn" data-id="${s.id}">${s.text}</button>
          `).join("")}
        </div>
        <div id="feedback-area" class="hidden"></div>
      </div>
    `,t.classList.remove("hidden"),this.attachEvents(e)}renderLevelData(e){return e.data?`
        <div class="data-panel">
          <ul>
            ${Object.entries(e.data).map(([t,s])=>`<li><strong>${t.toUpperCase()}:</strong> ${s}</li>`).join("")}
          </ul>
        </div>
      `:""}attachEvents(e){const t=document.getElementById("question-panel"),s=t.querySelectorAll(".option-btn"),i=t.querySelector("#feedback-area");s.forEach(a=>{a.addEventListener("click",()=>{this.disableAllButtons();const n=a.dataset.id;if(e.options.find(o=>o.id===n).correct)a.classList.add("correct"),this.handleSuccess(i,e.successMessage);else{a.classList.add("wrong");const o=Array.from(s).find(h=>e.options.find(d=>d.id===h.dataset.id).correct);o&&o.classList.add("correct"),this.mistakes++,this.handleFail(i,e.failMessage)}})})}handleSuccess(e,t){setTimeout(()=>{document.getElementById("question-panel").classList.add("hidden"),this.score+=100,this.updateScore(),this.arcade.destroyCurrentObstacle(()=>{this.nextLevel()})},1500)}handleFail(e,t){setTimeout(()=>{document.getElementById("question-panel").classList.add("hidden"),this.arcade.triggerImpact()},2e3)}nextLevel(){this.currentLevelIndex++,this.currentLevelIndex>=this.currentPhase.levels.length?this.handlePhaseComplete():this.arcade.spawnObstacle()}updateScore(){document.getElementById("score-val").textContent=this.score}disableAllButtons(){document.querySelectorAll(".option-btn").forEach(t=>t.disabled=!0)}handlePhaseComplete(){const e=this.currentPhase.id+1;this.phases.find(s=>s.id===e)&&!this.unlockedPhases.includes(e)&&this.unlockedPhases.push(e),setTimeout(()=>this.showEndScreen(!0),1e3)}showEndScreen(e){const t=e?"var(--neon-green)":"var(--neon-red)",s=e?"MISSION ACCOMPLISHED":"GAME OVER",i=e?"SECTOR CLEARED. EXCELLENT WORK, CADET.":"MISSION FAILED. PATIENT CRITICAL.";this.ui.container.innerHTML=`
      <div class="end-screen">
        <h1 style="color: ${t}; text-shadow: 4px 4px 0 #444;">${s}</h1>
        <p>${i}</p>

        <div class="final-score">
            SCORE<br>
            <span style="font-size: 32px;">${this.score}</span>
        </div>

        <button id="restart-btn" class="btn pulse">${e?"NEXT MISSION":"TRY AGAIN"}</button>
      </div>
    `,document.getElementById("restart-btn").addEventListener("click",()=>{e?this.showLevelSelection():this.renderStartScreen()})}}const m=new f;m.init();
