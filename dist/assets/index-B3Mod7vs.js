(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function s(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerPolicy&&(a.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?a.credentials="include":t.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(t){if(t.ep)return;t.ep=!0;const a=s(t);fetch(t.href,a)}})();const l=[{id:1,title:"Fase 1: A Triagem",description:"Paciente J.S., 25 anos. Qual o conjunto de sintomas mais indicativo de Anemia Ferropriva?",options:[{id:"s1",text:"Palidez, Taquicardia e Fadiga",correct:!0},{id:"s2",text:"Febre, Dor abdominal e Vômito",correct:!1},{id:"s3",text:"Hipertensão, Ganho de peso e Insônia",correct:!1},{id:"s4",text:"Manchas vermelhas na pele e Dor nas juntas",correct:!1}],successMessage:"Correto! Sintomas clássicos de hipóxia tecidual.",failMessage:"Incorreto. Esses sintomas não formam a tríade clássica da anemia."},{id:2,title:"Fase 2: O Laboratório",description:"Analise: Hb 9.0 g/dL, VCM 70 fL. Qual o diagnóstico provável?",data:{hemoglobina:"9.0 g/dL (Ref: 12-16)",vcm:"70 fL (Ref: 80-100)"},options:[{id:"a1",text:"Anemia Microcítica (Provável Ferropriva)",correct:!0},{id:"a2",text:"Anemia Macrocítica (Provável B12)",correct:!1},{id:"a3",text:"Anemia Normocítica (Doença Crônica)",correct:!1},{id:"a4",text:"Valores Normais",correct:!1}],successMessage:"Exato! VCM baixo indica microcitose, comum na falta de ferro.",failMessage:"Errado. Observe o VCM abaixo do valor de referência."},{id:3,title:"Fase 3: A Despensa",description:"Qual a melhor combinação para maximizar a absorção de ferro?",options:[{id:"f1",text:"Feijão + Suco de Laranja (Vitamina C)",correct:!0},{id:"f2",text:"Bife de Fígado + Café com Leite",correct:!1},{id:"f3",text:"Espinafre + Iogurte (Cálcio)",correct:!1},{id:"f4",text:"Ovo Cozido + Chá Preto",correct:!1}],successMessage:"Perfeito! A Vitamina C transforma o ferro férrico em ferroso, melhorando a absorção.",failMessage:"Cuidado! Cálcio e taninos (café/chá) inibem a absorção do ferro."},{id:4,title:"Fase 4: A Prescrição",description:"Qual a conduta terapêutica padrão para Anemia Ferropriva moderada?",options:[{id:"p1",text:"Sulfato Ferroso oral + Orientação Dietética",correct:!0},{id:"p2",text:"Apenas aumentar consumo de carne",correct:!1},{id:"p3",text:"Transfusão sanguínea imediata",correct:!1},{id:"p4",text:"Antibióticos e Repouso",correct:!1}],successMessage:"Correto! A reposição oral é o tratamento de escolha.",failMessage:"Inadequado. Apenas dieta não repõe estoques e transfusão é para casos graves."}];class u{constructor(){this.currentLevelIndex=0,this.score=0,this.mistakes=0,this.gameActive=!1,this.ui={app:document.getElementById("app"),container:document.getElementById("game-container"),loading:document.getElementById("loading-screen"),hud:document.getElementById("hud"),questionPanel:document.getElementById("question-panel")};const e=document.getElementById("question-panel");e.innerHTML=`
      <div class="panel-content">
        <h2>ALERTA DE COLISÃO!</h2>
        <p class="description">${level.description}</p>
        ${this.renderLevelData(level)}
        <div class="options-grid">
          ${level.options.map(s=>`
            <button class="option-btn" data-id="${s.id}">${s.text}</button>
          `).join("")}
        </div>
        <div id="feedback-area" class="hidden"></div>
      </div>
    `,e.classList.remove("hidden"),this.attachEvents(level)}renderLevelData(e){return e.data?`
        <div class="data-panel">
          <ul>
            ${Object.entries(e.data).map(([s,o])=>`<li><strong>${s.toUpperCase()}:</strong> ${o}</li>`).join("")}
          </ul>
        </div>
      `:""}attachEvents(e){const s=document.getElementById("question-panel"),o=s.querySelectorAll(".option-btn"),t=s.querySelector("#feedback-area");o.forEach(a=>{a.addEventListener("click",()=>{this.disableAllButtons();const i=a.dataset.id;if(e.options.find(r=>r.id===i).correct)a.classList.add("correct"),this.handleSuccess(t,e.successMessage);else{a.classList.add("wrong");const r=Array.from(o).find(c=>e.options.find(d=>d.id===c.dataset.id).correct);r&&r.classList.add("correct"),this.mistakes++,this.handleFail(t,e.failMessage)}})})}handleSuccess(e,s){e.textContent=s,e.className="feedback success",e.classList.remove("hidden"),setTimeout(()=>{document.getElementById("question-panel").classList.add("hidden"),this.arcade.shoot(),this.score+=100,this.updateScore(),this.nextLevel()},2e3)}handleFail(e,s){e.textContent=s,e.className="feedback fail",e.classList.remove("hidden"),setTimeout(()=>{document.getElementById("question-panel").classList.add("hidden"),this.arcade.takeDamage(),this.updateHealth(),this.nextLevel()},2e3)}nextLevel(){this.currentLevelIndex++,this.currentLevelIndex>=l.length?setTimeout(()=>this.showEndScreen(!0),2e3):setTimeout(()=>this.arcade.spawnObstacle(),3e3)}updateScore(){document.getElementById("score-val").textContent=this.score}updateHealth(){const e=Math.max(0,100-this.mistakes*25);document.getElementById("health-val").textContent=`${e}%`,e<=0&&this.showEndScreen(!1)}disableAllButtons(){document.querySelectorAll(".option-btn").forEach(s=>s.disabled=!0)}showEndScreen(e){this.ui.container.innerHTML=`
      <div class="end-screen">
        <h1>${e?"MISSÃO CUMPRIDA!":"FALHA NO PROTOCOLO"}</h1>
        <p>${e?"Você salvou a paciente e demonstrou excelente conhecimento em nutrição clínica.":"A paciente não recebeu o tratamento adequado a tempo."}</p>
        <div class="final-score">Score Final: ${this.score}</div>
        <button id="restart-btn" class="btn">Reiniciar Protocolo</button>
      </div>
    `,document.getElementById("restart-btn").addEventListener("click",()=>{this.startGame()})}}const m=new u;m.init();
