(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function s(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerPolicy&&(i.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?i.credentials="include":t.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(t){if(t.ep)return;t.ep=!0;const i=s(t);fetch(t.href,i)}})();const d=[{id:1,title:"Fase 1: A Triagem",description:"Paciente J.S., 25 anos, sexo feminino. Relata cansaço excessivo e falta de ar ao subir escadas. Identifique os sintomas que indicam possível anemia.",type:"selection",options:[{id:"s1",text:"Palidez cutâneo-mucosa",correct:!0},{id:"s2",text:"Bradicardia (coração lento)",correct:!1},{id:"s3",text:"Taquicardia (coração rápido)",correct:!0},{id:"s4",text:"Hipertensão",correct:!1},{id:"s5",text:"Fadiga / Astenia",correct:!0},{id:"s6",text:"Ganho de peso repentino",correct:!1}],minCorrect:3,maxMistakes:1,successMessage:"Sintomas identificados corretamente! O quadro clínico sugere anemia. Vamos investigar o sangue.",failMessage:"Diagnóstico incorreto. Revise os sinais clínicos de anemia."},{id:2,title:"Fase 2: O Laboratório",description:"Analise o Hemograma da paciente. Quais valores estão ALTERADOS indicando Anemia Ferropriva?",type:"analysis",data:{hemoglobina:"9.0 g/dL (Ref: 12-16)",hematocrito:"28% (Ref: 36-46)",vcm:"70 fL (Ref: 80-100)",ferritina:"10 ng/mL (Ref: 15-150)"},options:[{id:"a1",text:"Hemoglobina Baixa",correct:!0},{id:"a2",text:"Hematócrito Alto",correct:!1},{id:"a3",text:"VCM Baixo (Microcitose)",correct:!0},{id:"a4",text:"Ferritina Normal",correct:!1}],minCorrect:3,maxMistakes:1,successMessage:"Análise precisa! Anemia Microcítica e Hipocrômica confirmada. Causa provável: Deficiência de Ferro.",failMessage:"Interpretação incorreta dos exames."},{id:3,title:"Fase 3: A Despensa",description:"Monte uma refeição rica em Ferro para o tratamento. Selecione os alimentos corretos e evite inibidores.",type:"drag-drop",options:[{id:"f1",text:"Fígado Bovino",type:"food",correct:!0},{id:"f2",text:"Feijão Preto",type:"food",correct:!0},{id:"f3",text:"Suco de Laranja (Vitamina C)",type:"enhancer",correct:!0},{id:"f4",text:"Café / Chá Preto",type:"inhibitor",correct:!1},{id:"f5",text:"Leite (Cálcio)",type:"inhibitor",correct:!1},{id:"f6",text:"Couve Escura",type:"food",correct:!0}],minCorrect:4,maxMistakes:1,successMessage:"Refeição perfeita! A combinação de Ferro Heme, Não-Heme e Vitamina C otimiza a absorção.",failMessage:"Cuidado! Você escolheu alimentos com pouco ferro ou misturou com inibidores de absorção."},{id:4,title:"Fase 4: A Prescrição",description:"Qual a recomendação final para a paciente?",type:"quiz",options:[{id:"p1",text:"Apenas dieta é suficiente para repor estoques zerados.",correct:!1},{id:"p2",text:"Suplementação de Sulfato Ferroso + Dieta rica em ferro + Retorno em 3 meses.",correct:!0},{id:"p3",text:"Transfusão de sangue imediata.",correct:!1}],minCorrect:1,maxMistakes:0,successMessage:"Conduta correta! A paciente está no caminho da recuperação.",failMessage:"Conduta inadequada para o grau da anemia."}];class f{constructor(){this.currentLevelIndex=0,this.score=0,this.mistakes=0,this.gameActive=!1,this.ui={app:document.getElementById("app"),container:document.getElementById("game-container"),loading:document.getElementById("loading-screen")}}init(){setTimeout(()=>{this.ui.loading.classList.add("hidden"),this.startGame()},1500)}startGame(){this.currentLevelIndex=0,this.score=0,this.gameActive=!0,this.renderLevel()}renderLevel(){const e=d[this.currentLevelIndex];if(!e){this.showEndScreen(!0);return}this.ui.container.innerHTML=`
      <div class="level-header">
        <h2>${e.title}</h2>
        <div class="progress">Fase ${this.currentLevelIndex+1}/${d.length}</div>
      </div>
      <div class="level-content">
        <p class="description">${e.description}</p>
        ${this.renderLevelData(e)}
        <div class="options-grid">
          ${e.options.map(s=>`
            <button class="option-btn" data-id="${s.id}">${s.text}</button>
          `).join("")}
        </div>
        <div id="feedback-area" class="hidden"></div>
        <button id="next-btn" class="btn hidden">Próxima Fase</button>
      </div>
    `,this.attachEvents(e)}renderLevelData(e){return e.type==="analysis"&&e.data?`
        <div class="data-panel">
          <ul>
            ${Object.entries(e.data).map(([s,a])=>`<li><strong>${s.toUpperCase()}:</strong> ${a}</li>`).join("")}
          </ul>
        </div>
      `:""}attachEvents(e){const s=this.ui.container.querySelectorAll(".option-btn"),a=this.ui.container.querySelector("#next-btn"),t=this.ui.container.querySelector("#feedback-area");let i=0,o=0;const n=new Set;s.forEach(r=>{r.addEventListener("click",()=>{if(n.has(r.dataset.id))return;const c=r.dataset.id,u=e.options.find(m=>m.id===c);n.add(c),u.correct?(r.classList.add("correct"),i++):(r.classList.add("wrong"),o++,this.mistakes++),o>e.maxMistakes?(this.showFeedback(t,e.failMessage,!1),this.disableAllButtons(),setTimeout(()=>this.showEndScreen(!1),2e3)):i>=e.minCorrect&&(this.showFeedback(t,e.successMessage,!0),this.disableAllButtons(),a.classList.remove("hidden"))})}),a.addEventListener("click",()=>{this.currentLevelIndex++,this.renderLevel()})}showFeedback(e,s,a){e.textContent=s,e.className=a?"feedback success":"feedback fail",e.classList.remove("hidden")}disableAllButtons(){this.ui.container.querySelectorAll(".option-btn").forEach(s=>s.disabled=!0)}showEndScreen(e){this.ui.container.innerHTML=`
      <div class="end-screen">
        <h1>${e?"MISSÃO CUMPRIDA!":"FALHA NO PROTOCOLO"}</h1>
        <p>${e?"Você salvou a paciente e demonstrou excelente conhecimento em nutrição clínica.":"A paciente não recebeu o tratamento adequado a tempo."}</p>
        <button id="restart-btn" class="btn">Reiniciar Protocolo</button>
      </div>
    `,document.getElementById("restart-btn").addEventListener("click",()=>{this.startGame()})}}const p=new f;p.init();
