(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}})();const d=[{id:1,name:"FASE 1: CINTUR√ÉO DE ASTEROIDES",locked:!1,levels:[{id:1,description:"Paciente apresenta palidez cut√¢neo-mucosa e fadiga. Qual o valor de Hemoglobina (Hb) que define anemia em mulheres adultas n√£o gestantes?",data:{Satura√ß√£o:"98%",FC:"88 bpm"},options:[{id:"a",text:"Hb < 13.5 g/dL",correct:!1},{id:"b",text:"Hb < 12.0 g/dL",correct:!0},{id:"c",text:"Hb < 11.0 g/dL",correct:!1},{id:"d",text:"Hb < 10.0 g/dL",correct:!1}],successMessage:"Correto! Hb < 12.0 g/dL define anemia em mulheres.",failMessage:"Incorreto. O valor de corte √© 12.0 g/dL."},{id:2,description:"Qual √© a causa mais comum de anemia no mundo, caracterizada por microcitose e hipocromia?",data:{VCM:"70 fL",HCM:"22 pg"},options:[{id:"a",text:"Anemia Perniciosa",correct:!1},{id:"b",text:"Anemia Apl√°stica",correct:!1},{id:"c",text:"Anemia Ferropriva",correct:!0},{id:"d",text:"Anemia Falciforme",correct:!1}],successMessage:"Exato! A defici√™ncia de ferro √© a causa mais comum.",failMessage:"Errado. Microcitose sugere falta de ferro."},{id:3,description:"Para melhorar a absor√ß√£o de sulfato ferroso oral, qual orienta√ß√£o de enfermagem √© correta?",data:{Prescri√ß√£o:"Sulfato Ferroso 40mg"},options:[{id:"a",text:"Tomar com leite ou iogurte",correct:!1},{id:"b",text:"Tomar com anti√°cidos",correct:!1},{id:"c",text:"Tomar logo ap√≥s o almo√ßo",correct:!1},{id:"d",text:"Tomar com suco de laranja (Vitamina C)",correct:!0}],successMessage:"Perfeito! O ambiente √°cido favorece a absor√ß√£o.",failMessage:"N√£o. C√°lcio e anti√°cidos diminuem a absor√ß√£o."},{id:4,description:"A Anemia Perniciosa √© causada pela defici√™ncia de qual vitamina?",data:{Sintomas:"Parestesias, Glossite"},options:[{id:"a",text:"Vitamina B12 (Cobalamina)",correct:!0},{id:"b",text:"Vitamina B9 (√Åcido F√≥lico)",correct:!1},{id:"c",text:"Vitamina C",correct:!1},{id:"d",text:"Vitamina D",correct:!1}],successMessage:"Correto! Falta de Fator Intr√≠nseco impede absor√ß√£o de B12.",failMessage:"Incorreto. √â defici√™ncia de B12."},{id:5,description:"Na administra√ß√£o intramuscular de ferro (Noripurum), qual t√©cnica deve ser utilizada para evitar manchas na pele?",data:{Via:"Intramuscular Profunda"},options:[{id:"a",text:"T√©cnica em Z (Z-track)",correct:!0},{id:"b",text:"Prega cut√¢nea simples",correct:!1},{id:"c",text:"Massagem vigorosa ap√≥s aplica√ß√£o",correct:!1},{id:"d",text:"Aplica√ß√£o no deltoide",correct:!1}],successMessage:"Excelente! A t√©cnica em Z evita o refluxo do medicamento.",failMessage:"Errado. Deve-se usar a t√©cnica em Z no gl√∫teo."}]},{id:2,name:"FASE 2: NEBULOSA ESCURA",locked:!1,levels:[{id:6,description:"Paciente com Anemia Falciforme apresenta crise √°lgica intensa. Qual a prioridade inicial de enfermagem al√©m da analgesia?",data:{Queixa:"Dor 10/10",Sat:"92%"},options:[{id:"a",text:"Restri√ß√£o h√≠drica",correct:!1},{id:"b",text:"Hidrata√ß√£o vigorosa e Oxigenoterapia",correct:!0},{id:"c",text:"Exerc√≠cios f√≠sicos",correct:!1},{id:"d",text:"Aplica√ß√£o de frio no local",correct:!1}],successMessage:"Correto! Hidrata√ß√£o reduz a falciza√ß√£o das hem√°cias.",failMessage:"Incorreto. Hidrata√ß√£o √© fundamental."},{id:7,description:"Quais alimentos s√£o as melhores fontes de ferro heme (melhor absor√ß√£o)?",data:{Dieta:"Avalia√ß√£o Nutricional"},options:[{id:"a",text:"Feij√£o e Lentilha",correct:!1},{id:"b",text:"Espinafre e Couve",correct:!1},{id:"c",text:"Carnes vermelhas e v√≠sceras",correct:!0},{id:"d",text:"Leite e Derivados",correct:!1}],successMessage:"Isso! Ferro heme (origem animal) √© melhor absorvido.",failMessage:"Incorreto. Vegetais t√™m ferro n√£o-heme."},{id:8,description:"Em um hemograma, o que indica o √≠ndice RDW (Red Cell Distribution Width) elevado?",data:{RDW:"18%"},options:[{id:"a",text:"Tamanho uniforme das hem√°cias",correct:!1},{id:"b",text:"Anisocitose (varia√ß√£o no tamanho)",correct:!0},{id:"c",text:"Excesso de ferro",correct:!1},{id:"d",text:"Infec√ß√£o bacteriana",correct:!1}],successMessage:"Correto! RDW alto indica anisocitose, comum na car√™ncia de ferro.",failMessage:"Errado. RDW mede a varia√ß√£o de tamanho."},{id:9,description:"Durante uma transfus√£o sangu√≠nea, o paciente relata dor lombar e febre. Qual a primeira a√ß√£o da enfermagem?",data:{Tempo:"15 min de infus√£o"},options:[{id:"a",text:"Aumentar o gotejamento",correct:!1},{id:"b",text:"Administrar analg√©sico",correct:!1},{id:"c",text:"Interromper a transfus√£o imediatamente",correct:!0},{id:"d",text:"Chamar o m√©dico e continuar infundindo",correct:!1}],successMessage:"Exato! Sinais de rea√ß√£o hemol√≠tica exigem parada imediata.",failMessage:"Erro Cr√≠tico! Deve-se parar a transfus√£o imediatamente."},{id:10,description:"Qual destes sintomas √© caracter√≠stico da s√≠ndrome de Pica (alotriofagia) associada √† anemia ferropriva?",data:{Obs:"Comportamento alimentar"},options:[{id:"a",text:"Vontade de comer doces",correct:!1},{id:"b",text:"Vontade de comer gelo, terra ou reboco",correct:!0},{id:"c",text:"Perda de apetite total",correct:!1},{id:"d",text:"Sede excessiva",correct:!1}],successMessage:"Correto! Pagofagia (comer gelo) √© comum na ferropriva.",failMessage:"Incorreto. Pica √© o desejo por itens n√£o nutritivos."}]}];class u{constructor(t,e,i){this.canvas=document.getElementById(t),this.ctx=this.canvas.getContext("2d"),this.onObstacleEncountered=e,this.onGameOver=i,this.width=window.innerWidth,this.height=window.innerHeight,this.canvas.width=this.width,this.canvas.height=this.height,this.ship={x:100,y:this.height/2,size:30,speed:5,visible:!0},this.asteroids=[],this.stars=[],this.lasers=[],this.particles=[],this.gameActive=!1,this.isPaused=!1,this.lastTime=0,this.spawnTimer=0,this.obstaclePending=!1,this.isCrashing=!1,this.onObstacleDestroyed=null,this.initStars(),window.addEventListener("resize",()=>this.resize())}resize(){this.width=window.innerWidth,this.height=window.innerHeight,this.canvas.width=this.width,this.canvas.height=this.height,this.initStars()}initStars(){this.stars=[];for(let t=0;t<150;t++)this.stars.push({x:Math.random()*this.width,y:Math.random()*this.height,size:Math.random()*2,speed:Math.random()*3+.5})}start(){this.gameActive=!0,this.isPaused=!1,this.obstaclePending=!1,this.isCrashing=!1,this.asteroids=[],this.lasers=[],this.particles=[],this.ship.visible=!0,this.lastTime=performance.now(),this.loop(this.lastTime)}spawnObstacle(){this.asteroids=this.asteroids.filter(t=>!t.active),!this.obstaclePending&&(this.asteroids.push({x:this.width+50,y:this.height/2,size:60,hp:1,active:!0,doomed:!1}),this.obstaclePending=!0,this.isCrashing=!1)}destroyCurrentObstacle(t){this.isPaused=!1;const e=this.asteroids.find(i=>i.active);this.lasers.push({x:this.ship.x+this.ship.size,y:this.ship.y,speed:40,active:!0}),e?(e.doomed=!0,this.onObstacleDestroyed=t):t&&setTimeout(t,500)}triggerImpact(){this.isPaused=!1,this.obstaclePending=!1,this.isCrashing=!0}destroyShip(){this.gameActive&&(this.isPaused=!1,this.createExplosion(this.ship.x,this.ship.y,"#ff0000",80),this.createExplosion(this.ship.x,this.ship.y,"#ffff00",40),this.ship.visible=!1,this.gameActive=!1,setTimeout(()=>{this.onGameOver&&this.onGameOver()},2500))}createExplosion(t,e,i,s){this.particles.push({type:"shockwave",x:t,y:e,size:5,grow:15,alpha:1,color:i});for(let a=0;a<s;a++){const o=Math.random()*Math.PI*2,n=Math.random()*15+5;this.particles.push({type:"debris",x:t,y:e,vx:Math.cos(o)*n,vy:Math.sin(o)*n,life:1,decay:Math.random()*.03+.01,color:i,size:Math.random()*4+2})}}update(t){this.isPaused||(this.stars.forEach(e=>{e.x-=e.speed,e.x<0&&(e.x=this.width)}),this.asteroids.forEach(e=>{if(!e.active)return;let i=5;if(this.isCrashing&&(i=25),e.x-=i,!this.isCrashing&&e.x<this.width-300&&this.obstaclePending&&(this.isPaused=!0,this.obstaclePending=!1,this.onObstacleEncountered()),this.ship.visible){const s=e.x-this.ship.x,a=e.y-this.ship.y;Math.sqrt(s*s+a*a)<(e.size+this.ship.size)*.8&&this.destroyShip()}}),this.lasers.forEach(e=>{e.active&&(e.x+=e.speed,e.x>this.width&&(e.active=!1),this.asteroids.forEach(i=>{if(i.active&&i.doomed){const s=e.x-i.x,a=e.y-i.y;Math.sqrt(s*s+a*a)<i.size+20&&(i.active=!1,e.active=!1,this.createExplosion(i.x,i.y,"#ffaa00",40),this.createExplosion(i.x,i.y,"#ffffff",20),this.onObstacleDestroyed&&setTimeout(()=>{this.onObstacleDestroyed(),this.onObstacleDestroyed=null},1e3))}}))}),this.particles.forEach(e=>{e.type==="shockwave"?(e.size+=e.grow,e.alpha-=.05):(e.x+=e.vx,e.y+=e.vy,e.life-=e.decay,e.vx*=.95,e.vy*=.95)}),this.particles=this.particles.filter(e=>e.type==="shockwave"?e.alpha>0:e.life>0))}draw(){this.ctx.fillStyle="#000000",this.ctx.fillRect(0,0,this.width,this.height),this.ctx.fillStyle="#ffffff",this.stars.forEach(t=>{this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.size,0,Math.PI*2),this.ctx.fill()}),this.ship.visible&&(this.ctx.save(),this.ctx.translate(this.ship.x,this.ship.y),this.ctx.shadowBlur=20,this.ctx.shadowColor="#00ffff",this.ctx.fillStyle=`rgba(0, 255, 255, ${.5+Math.random()*.5})`,this.ctx.beginPath(),this.ctx.moveTo(-25,-5),this.ctx.lineTo(-45-Math.random()*10,0),this.ctx.lineTo(-25,5),this.ctx.fill(),this.ctx.shadowBlur=0,this.ctx.fillStyle="#2a2a2a",this.ctx.beginPath(),this.ctx.moveTo(30,0),this.ctx.lineTo(-20,15),this.ctx.lineTo(-15,5),this.ctx.lineTo(-25,5),this.ctx.lineTo(-25,-5),this.ctx.lineTo(-15,-5),this.ctx.lineTo(-20,-15),this.ctx.closePath(),this.ctx.fill(),this.ctx.fillStyle="#00ffff",this.ctx.beginPath(),this.ctx.ellipse(5,0,8,4,0,0,Math.PI*2),this.ctx.fill(),this.ctx.strokeStyle="#00ff00",this.ctx.lineWidth=2,this.ctx.beginPath(),this.ctx.moveTo(-10,10),this.ctx.lineTo(10,0),this.ctx.lineTo(-10,-10),this.ctx.stroke(),this.ctx.restore()),this.asteroids.forEach(t=>{if(!t.active)return;if(this.ctx.save(),this.ctx.translate(t.x,t.y),this.ctx.rotate(t.x*.02),!t.vertices){t.vertices=[];const i=8+Math.floor(Math.random()*4);for(let s=0;s<i;s++){const a=s/i*Math.PI*2,o=t.size*(.8+Math.random()*.4);t.vertices.push({x:Math.cos(a)*o,y:Math.sin(a)*o})}}this.ctx.fillStyle="#555",this.ctx.beginPath(),t.vertices.forEach((i,s)=>{s===0?this.ctx.moveTo(i.x,i.y):this.ctx.lineTo(i.x,i.y)}),this.ctx.closePath(),this.ctx.fill();const e=this.ctx.createRadialGradient(-10,-10,5,0,0,t.size);e.addColorStop(0,"rgba(255, 255, 255, 0.1)"),e.addColorStop(1,"rgba(0, 0, 0, 0.4)"),this.ctx.fillStyle=e,this.ctx.fill(),this.ctx.fillStyle="rgba(0, 0, 0, 0.3)",this.ctx.beginPath(),this.ctx.arc(t.size*.3,t.size*.2,t.size*.2,0,Math.PI*2),this.ctx.fill(),this.ctx.beginPath(),this.ctx.arc(-t.size*.4,-t.size*.1,t.size*.15,0,Math.PI*2),this.ctx.fill(),this.ctx.restore()}),this.ctx.fillStyle="#00ffff",this.ctx.shadowBlur=10,this.ctx.shadowColor="#00ffff",this.lasers.forEach(t=>{t.active&&this.ctx.fillRect(t.x,t.y-3,40,6)}),this.ctx.shadowBlur=0,this.particles.forEach(t=>{t.type==="shockwave"?(this.ctx.strokeStyle=t.color,this.ctx.lineWidth=3,this.ctx.globalAlpha=t.alpha,this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.size,0,Math.PI*2),this.ctx.stroke()):(this.ctx.fillStyle=t.color,this.ctx.globalAlpha=t.life,this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.size,0,Math.PI*2),this.ctx.fill()),this.ctx.globalAlpha=1})}loop(t){const e=t-this.lastTime;this.lastTime=t,this.update(e),this.draw(),(this.gameActive||this.particles.length>0)&&requestAnimationFrame(i=>this.loop(i))}resume(){this.isPaused=!1,this.lastTime=performance.now()}stop(){this.gameActive=!1,this.particles=[],this.asteroids=[],this.lasers=[]}}class m{constructor(t,e,i){this.canvas=document.getElementById(t),this.ctx=this.canvas.getContext("2d"),this.onRescueAttempt=e,this.onGameOver=i,this.width=window.innerWidth,this.height=window.innerHeight,this.canvas.width=this.width,this.canvas.height=this.height,this.state="IDLE",this.gameActive=!1,this.isPaused=!1,this.lastTime=0,this.ship={x:this.width/2,y:80,size:40,targetX:this.width/2},this.astronaut={x:this.width/2,y:this.height-150,size:20,angle:0,color:"#ffffff",visible:!0},this.blackHole={x:this.width/2,y:this.height+100,radius:150,angle:0},this.rope={length:0,targetLength:0,connected:!1,snapped:!1},this.stars=[],this.colors=["#ffffff","#ff0000","#00ff00","#ffff00","#00ffff","#ff00ff"],this.initStars(),window.addEventListener("resize",()=>this.resize())}resize(){this.width=window.innerWidth,this.height=window.innerHeight,this.canvas.width=this.width,this.canvas.height=this.height,this.initStars(),this.state==="IDLE"&&(this.ship.x=this.width/2,this.ship.y=80,this.astronaut.x=this.width/2,this.astronaut.y=this.height-150,this.blackHole.x=this.width/2,this.blackHole.y=this.height+100)}initStars(){this.stars=[];for(let t=0;t<100;t++)this.stars.push({x:Math.random()*this.width,y:Math.random()*this.height,size:Math.random()*2,speed:Math.random()*.5+.1})}start(){this.gameActive=!0,this.isPaused=!1,this.state="IDLE",this.lastTime=performance.now(),this.loop(this.lastTime)}spawnObstacle(){this.state="IDLE",this.astronaut.visible=!0,this.astronaut.y=this.height-150,this.astronaut.x=this.width/2,this.astronaut.angle=0,this.astronaut.color=this.colors[Math.floor(Math.random()*this.colors.length)],this.rope.length=0,this.rope.connected=!1,this.rope.snapped=!1,setTimeout(()=>{this.onRescueAttempt()},1e3)}destroyCurrentObstacle(t){this.state="DROPPING_ROPE",this.rope.targetLength=this.astronaut.y-this.ship.y,this.onRescueComplete=t}triggerImpact(){this.state="SNAP_ROPE",this.rope.snapped=!0,setTimeout(()=>{this.state="SUCKING_IN"},500)}update(t){if(!this.isPaused)switch(this.stars.forEach(e=>{e.y-=e.speed,e.y<0&&(e.y=this.height),e.x<0&&(e.x=this.width),e.x>this.width&&(e.x=0)}),this.blackHole.angle+=.02,this.state){case"IDLE":this.astronaut.y=this.height-150+Math.sin(Date.now()/500)*5;break;case"DROPPING_ROPE":this.rope.length+=20,this.rope.length>=this.rope.targetLength&&(this.rope.length=this.rope.targetLength,this.rope.connected=!0,this.state="PULLING_UP");break;case"PULLING_UP":this.rope.length-=10,this.astronaut.y=this.ship.y+this.rope.length,this.astronaut.angle+=.1,this.rope.length<=40&&(this.astronaut.visible=!1,this.state="MOVING_SHIP");break;case"MOVING_SHIP":this.stars.forEach(s=>s.x-=5),this.moveTimer||(this.moveTimer=Date.now()),Date.now()-this.moveTimer>1500&&(this.moveTimer=null,this.onRescueComplete&&(this.onRescueComplete(),this.onRescueComplete=null));break;case"SNAP_ROPE":break;case"SUCKING_IN":const e=this.blackHole.x-this.astronaut.x,i=this.blackHole.y-this.astronaut.y;this.astronaut.x+=e*.05,this.astronaut.y+=i*.05,this.astronaut.angle+=.2,this.astronaut.size*=.99,this.astronaut.y>this.height&&this.onGameOver&&this.onGameOver();break}}draw(){this.ctx.fillStyle="#000000",this.ctx.fillRect(0,0,this.width,this.height),this.ctx.fillStyle="#ffffff",this.stars.forEach(o=>{this.ctx.beginPath(),this.ctx.arc(o.x,o.y,o.size,0,Math.PI*2),this.ctx.fill()}),this.ctx.save(),this.ctx.translate(this.blackHole.x,this.blackHole.y),this.ctx.rotate(this.blackHole.angle);const t=this.ctx.createRadialGradient(0,0,150,0,0,250);t.addColorStop(0,"rgba(138, 43, 226, 0.3)"),t.addColorStop(.5,"rgba(75, 0, 130, 0.2)"),t.addColorStop(1,"rgba(0, 0, 0, 0)"),this.ctx.fillStyle=t,this.ctx.beginPath(),this.ctx.arc(0,0,250,0,Math.PI*2),this.ctx.fill();const e=this.ctx.createRadialGradient(0,0,100,0,0,180);e.addColorStop(0,"rgba(255, 69, 0, 0)"),e.addColorStop(.3,"rgba(255, 69, 0, 0.6)"),e.addColorStop(.6,"rgba(255, 140, 0, 0.4)"),e.addColorStop(1,"rgba(0, 0, 0, 0)"),this.ctx.fillStyle=e,this.ctx.beginPath(),this.ctx.arc(0,0,180,0,Math.PI*2),this.ctx.fill();const i=this.ctx.createRadialGradient(0,0,70,0,0,130);i.addColorStop(0,"rgba(255, 255, 255, 0)"),i.addColorStop(.3,"rgba(255, 255, 100, 0.8)"),i.addColorStop(.7,"rgba(255, 165, 0, 0.5)"),i.addColorStop(1,"rgba(0, 0, 0, 0)"),this.ctx.fillStyle=i,this.ctx.beginPath(),this.ctx.arc(0,0,130,0,Math.PI*2),this.ctx.fill(),this.ctx.strokeStyle="rgba(255, 100, 0, 0.3)",this.ctx.lineWidth=3;for(let o=0;o<3;o++){this.ctx.beginPath();for(let n=0;n<Math.PI*4;n+=.1){const c=80+n*8,r=Math.cos(n+o*Math.PI*2/3)*c,l=Math.sin(n+o*Math.PI*2/3)*c;n===0?this.ctx.moveTo(r,l):this.ctx.lineTo(r,l)}this.ctx.stroke()}this.ctx.strokeStyle="rgba(255, 255, 255, 0.8)",this.ctx.lineWidth=2,this.ctx.beginPath(),this.ctx.arc(0,0,75,0,Math.PI*2),this.ctx.stroke();const s=.5+Math.sin(Date.now()/200)*.3,a=this.ctx.createRadialGradient(0,0,40,0,0,70);a.addColorStop(0,`rgba(138, 43, 226, ${s})`),a.addColorStop(.5,`rgba(75, 0, 130, ${s*.6})`),a.addColorStop(1,"rgba(0, 0, 0, 0)"),this.ctx.fillStyle=a,this.ctx.beginPath(),this.ctx.arc(0,0,70,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="#000000",this.ctx.beginPath(),this.ctx.arc(0,0,50,0,Math.PI*2),this.ctx.fill(),this.ctx.strokeStyle="rgba(138, 43, 226, 0.9)",this.ctx.lineWidth=3,this.ctx.stroke(),this.ctx.restore(),(this.state==="DROPPING_ROPE"||this.state==="PULLING_UP"||this.state==="SNAP_ROPE")&&(this.ctx.strokeStyle=this.state==="SNAP_ROPE"?"#ff0000":"#ffffff",this.ctx.lineWidth=3,this.ctx.beginPath(),this.ctx.moveTo(this.ship.x,this.ship.y+20),this.state==="SNAP_ROPE"?this.ctx.lineTo(this.ship.x+(Math.random()-.5)*20,this.ship.y+100):this.ctx.lineTo(this.ship.x,this.ship.y+this.rope.length),this.ctx.stroke()),this.ctx.save(),this.ctx.translate(this.ship.x,this.ship.y),this.ctx.fillStyle="#444",this.ctx.beginPath(),this.ctx.moveTo(-30,-20),this.ctx.lineTo(30,-20),this.ctx.lineTo(35,10),this.ctx.lineTo(20,25),this.ctx.lineTo(-20,25),this.ctx.lineTo(-35,10),this.ctx.closePath(),this.ctx.fill(),this.ctx.fillStyle="#feda4a",this.ctx.beginPath(),this.ctx.moveTo(-30,-15),this.ctx.lineTo(30,-15),this.ctx.lineTo(30,-10),this.ctx.lineTo(-30,-10),this.ctx.fill(),this.ctx.fillStyle="#00ffff",this.ctx.beginPath(),this.ctx.rect(-15,-5,30,10),this.ctx.fill(),this.ctx.fillStyle=`rgba(0, 255, 255, ${.5+Math.random()*.5})`,this.ctx.beginPath(),this.ctx.arc(-25,25,5+Math.random()*2,0,Math.PI*2),this.ctx.arc(25,25,5+Math.random()*2,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="#666",this.ctx.fillRect(-8,20,16,10),this.ctx.strokeStyle="#333",this.ctx.lineWidth=2,this.ctx.strokeRect(-8,20,16,10),this.ctx.restore(),this.astronaut.visible&&(this.ctx.save(),this.ctx.translate(this.astronaut.x,this.astronaut.y),this.ctx.rotate(this.astronaut.angle),this.ctx.fillStyle="#ccc",this.ctx.fillRect(-12,-15,24,30),this.ctx.fillStyle=this.astronaut.color,this.ctx.beginPath(),this.ctx.roundRect(-10,-15,20,30,5),this.ctx.fill(),this.ctx.fillStyle="#fff",this.ctx.beginPath(),this.ctx.arc(0,-15,12,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="#ffd700",this.ctx.beginPath(),this.ctx.ellipse(0,-15,8,6,0,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="rgba(255, 255, 255, 0.8)",this.ctx.beginPath(),this.ctx.ellipse(-3,-17,2,1,.5,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle=this.astronaut.color,this.ctx.beginPath(),this.ctx.arc(-12,-5,4,0,Math.PI*2),this.ctx.arc(12,-5,4,0,Math.PI*2),this.ctx.fill(),this.ctx.beginPath(),this.ctx.arc(-6,18,4,0,Math.PI*2),this.ctx.arc(6,18,4,0,Math.PI*2),this.ctx.fill(),(this.state==="IDLE"||this.state==="SUCKING_IN")&&(this.ctx.fillStyle="#ff0000",this.ctx.font="12px Arial",this.ctx.textAlign="center",this.ctx.fillText(this.state==="SUCKING_IN"?"AAAAHH!":"HELP!",0,-35)),this.ctx.restore()),this.state==="PULLING_UP"&&(this.ctx.fillStyle="#00ff00",this.ctx.font='20px "Press Start 2P"',this.ctx.textAlign="center",this.ctx.fillText("RESCUING...",this.width/2,this.height/2))}loop(t){const e=t-this.lastTime;this.lastTime=t,this.update(e),this.draw(),this.gameActive&&requestAnimationFrame(i=>this.loop(i))}stop(){this.gameActive=!1}}class f{constructor(){this.audioContext=null,this.sounds={},this.ambientOscillator=null,this.ambientGain=null,this.masterVolume=.3,this.muted=!1,this.initialized=!1}async init(){if(!this.initialized)try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.initialized=!0,this.createBeepSound(),this.createClickSound(),this.createVictorySound(),this.createDefeatSound()}catch(t){console.warn("Audio initialization failed:",t)}}startAmbient(){if(!(!this.audioContext||this.muted))try{this.audioContext.state==="suspended"&&this.audioContext.resume(),this.ambientOscillator=this.audioContext.createOscillator(),this.ambientGain=this.audioContext.createGain(),this.ambientOscillator.type="sine",this.ambientOscillator.frequency.setValueAtTime(55,this.audioContext.currentTime),this.ambientGain.gain.setValueAtTime(0,this.audioContext.currentTime),this.ambientGain.gain.linearRampToValueAtTime(this.masterVolume*.1,this.audioContext.currentTime+2),this.ambientOscillator.connect(this.ambientGain),this.ambientGain.connect(this.audioContext.destination),this.ambientOscillator.start()}catch(t){console.warn("Ambient sound failed:",t)}}stopAmbient(){if(this.ambientOscillator)try{this.ambientGain.gain.linearRampToValueAtTime(0,this.audioContext.currentTime+1),setTimeout(()=>{this.ambientOscillator&&(this.ambientOscillator.stop(),this.ambientOscillator=null)},1e3)}catch(t){console.warn("Stop ambient failed:",t)}}createBeepSound(){this.sounds.beep=()=>{if(!this.audioContext||this.muted)return;const t=this.audioContext.createOscillator(),e=this.audioContext.createGain();t.type="sine",t.frequency.setValueAtTime(800,this.audioContext.currentTime),e.gain.setValueAtTime(this.masterVolume*.1,this.audioContext.currentTime),e.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.1),t.connect(e),e.connect(this.audioContext.destination),t.start(),t.stop(this.audioContext.currentTime+.1)}}createClickSound(){this.sounds.click=()=>{if(!this.audioContext||this.muted)return;const t=this.audioContext.createOscillator(),e=this.audioContext.createGain();t.type="square",t.frequency.setValueAtTime(400,this.audioContext.currentTime),t.frequency.exponentialRampToValueAtTime(100,this.audioContext.currentTime+.1),e.gain.setValueAtTime(this.masterVolume*.2,this.audioContext.currentTime),e.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.1),t.connect(e),e.connect(this.audioContext.destination),t.start(),t.stop(this.audioContext.currentTime+.1)}}createVictorySound(){this.sounds.victory=()=>{if(!this.audioContext||this.muted)return;const t=[523.25,659.25,783.99],e=this.audioContext.currentTime;t.forEach((i,s)=>{const a=this.audioContext.createOscillator(),o=this.audioContext.createGain();a.type="sine",a.frequency.setValueAtTime(i,e+s*.15),o.gain.setValueAtTime(0,e+s*.15),o.gain.linearRampToValueAtTime(this.masterVolume*.3,e+s*.15+.05),o.gain.exponentialRampToValueAtTime(.01,e+s*.15+.4),a.connect(o),o.connect(this.audioContext.destination),a.start(e+s*.15),a.stop(e+s*.15+.4)})}}createDefeatSound(){this.sounds.defeat=()=>{if(!this.audioContext||this.muted)return;const t=this.audioContext.createOscillator(),e=this.audioContext.createGain();t.type="sawtooth",t.frequency.setValueAtTime(400,this.audioContext.currentTime),t.frequency.exponentialRampToValueAtTime(100,this.audioContext.currentTime+.5),e.gain.setValueAtTime(this.masterVolume*.3,this.audioContext.currentTime),e.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+.5),t.connect(e),e.connect(this.audioContext.destination),t.start(),t.stop(this.audioContext.currentTime+.5)}}playSound(t){this.sounds[t]&&this.sounds[t]()}toggleMute(){return this.muted=!this.muted,this.muted&&this.stopAmbient(),this.muted}setVolume(t){this.masterVolume=Math.max(0,Math.min(1,t))}}class x{constructor(){this.currentLevelIndex=0,this.score=0,this.mistakes=0,this.gameActive=!1,this.ui={app:document.getElementById("app"),container:document.getElementById("game-container"),loading:document.getElementById("loading-screen"),hud:document.getElementById("hud"),questionPanel:document.getElementById("question-panel")},this.arcade=null,this.phases=d,this.unlockedPhases=d.map(t=>t.id),this.currentPhase=null,this.audioManager=new f,this.starCanvas=null,this.starAnimationId=null}init(){setTimeout(()=>{this.ui.loading.classList.add("hidden"),this.renderStartScreen()},1500)}renderStartScreen(){this.createStarField(),this.ui.container.innerHTML=`
      <div class="start-screen">
        <h1 class="glitch" data-text="HEMOGLOBINA ZERO">HEMOGLOBINA<br>ZERO</h1>
        <p class="subtitle">MISS√ÉO DE RESGATE CELULAR</p>
        <div class="instructions">
          <p>OBJETIVO: RESPONDER PERGUNTAS DE SA√öDE</p>
          <p>MEC√ÇNICA: DESTRUIR ASTEROIDES E RESGATAR ASTRONAUTAS</p>
          <p>TEMA: ANEMIA E HEMOGLOBINA</p>
        </div>
        <div style="margin-bottom: 20px; color: var(--neon-yellow); font-size: 12px;">CR√âDITO 01</div>
        <button id="start-btn" class="btn pulse">INSERIR FICHA / INICIAR</button>
      </div>
    `;const t=document.getElementById("start-btn");t.addEventListener("mouseenter",()=>this.audioManager.playSound("beep")),t.addEventListener("click",async()=>{await this.audioManager.init(),this.audioManager.playSound("click"),this.audioManager.startAmbient(),this.starAnimationId&&cancelAnimationFrame(this.starAnimationId),this.showLevelSelection()})}showLevelSelection(){this.createStarField(),this.ui.container.innerHTML=`
      <div class="level-selection-modal">
        <h2 style="color: var(--neon-blue); text-shadow: 0 0 10px var(--neon-blue);">SELECIONAR MISS√ÉO</h2>
        <div class="level-grid">
          ${this.phases.map(t=>{const e=!this.unlockedPhases.includes(t.id);return`
              <div class="level-card ${e?"locked":""}" data-id="${t.id}">
                ${e?'<div class="lock-icon">üîí</div>':""}
                <h3>${t.name}</h3>
                <p>${e?"BLOQUEADO":`${t.levels.length} PERGUNTAS`}</p>
              </div>`}).join("")}
        </div>
        <button id="back-btn" class="btn back-btn">VOLTAR</button>
      </div>
    `,document.querySelectorAll(".level-card").forEach(t=>{t.addEventListener("click",()=>{const e=parseInt(t.dataset.id);console.log("Level card clicked, id:",e),this.unlockedPhases.includes(e)?(console.log("Starting game for phase",e),this.startGame(e)):console.log("Phase locked:",e)})}),document.getElementById("back-btn").addEventListener("click",()=>{console.log("Back button clicked, returning to start screen"),this.renderStartScreen()})}startGame(t){this.currentPhase=this.phases.find(e=>e.id===t),this.showStoryIntro(t)}showStoryIntro(t){const i={1:{title:"CRISE DE ASTEROIDES",text:`Sua tripula√ß√£o entrou em um perigoso campo de asteroides enquanto transportava suprimentos de sa√∫de cr√≠ticos.

O sistema de navega√ß√£o falhou e os asteroides est√£o se aproximando rapidamente.

Voc√™ deve responder corretamente √†s perguntas de sa√∫de para destruir os asteroides e salvar sua tripula√ß√£o.

Uma resposta errada significa destrui√ß√£o certa...`},2:{title:"RESGATE DO BURACO NEGRO",text:`Um enorme buraco negro apareceu pr√≥ximo √† esta√ß√£o de sa√∫de, puxando astronautas para sua gravidade.

Voc√™ est√° pilotando a nave de resgate HEMO-1, equipada com um sistema de cabo de emerg√™ncia.

Responda corretamente √†s perguntas para acionar a corda de resgate e salvar os astronautas.

Falhar significa que eles ser√£o perdidos para sempre no horizonte de eventos do buraco negro...`}}[t];this.ui.container.innerHTML=`
      <div class="story-intro">
        <div class="crawl-container">
          <div class="crawl-text">
            <h1>${i.title}</h1>
            <p>${i.text.replace(/\n/g,"<br>")}</p>
          </div>
        </div>
        <button id="start-mission-btn" class="btn pulse" style="display:none; margin-top:20px;">INICIAR MISS√ÉO</button>
      </div>
    `,setTimeout(()=>{const s=document.getElementById("start-mission-btn");s&&(s.style.display="inline-block")},3e4),document.getElementById("start-mission-btn").addEventListener("click",()=>{this.audioManager.playSound("click"),this.actuallyStartGame(t)})}actuallyStartGame(t){this.removeStarField(),this.currentPhase=this.phases.find(e=>e.id===t),this.currentLevelIndex=0,this.score=0,this.mistakes=0,this.gameActive=!0,this.ui.container.innerHTML=`
  < canvas id = "game-canvas" ></canvas >
      <div id="hud" class="hud">
        <div class="score">SCORE: <span id="score-val">0</span></div>
        <div style="font-size: 12px; margin-top: 5px; color: var(--neon-blue);">
          ${this.currentPhase.name}
        </div>
      </div>
      <div id="question-panel" class="question-panel hidden"></div>
`,this.currentPhase.id===1?this.arcade=new u("game-canvas",()=>this.showQuestion(),()=>this.showEndScreen(!1)):this.arcade=new m("game-canvas",()=>this.showQuestion(),()=>this.showEndScreen(!1)),this.arcade.start(),setTimeout(()=>this.arcade.spawnObstacle(),2e3)}showQuestion(){const t=this.currentPhase.levels[this.currentLevelIndex];if(!t){this.showEndScreen(!0);return}const e=document.getElementById("question-panel");e.innerHTML=`
  < div class="panel-content" >
        <h2>${this.currentPhase.id===2?"ASTRONAUTA EM PERIGO!":"ALERTA DE COLIS√ÉO!"}</h2>
        <p class="description">${t.description}</p>
        ${this.renderLevelData(t)}
        <div class="options-grid">
          ${t.options.map(i=>`<button class="option-btn" data-id="${i.id}">${i.text}</button>`).join("")}
        </div>
        <div id="feedback-area" class="hidden"></div>
      </div >
  `,e.classList.remove("hidden"),this.attachEvents(t)}renderLevelData(t){return t.data?`
  < div class="data-panel" >
    <ul>
      ${Object.entries(t.data).map(([e,i])=>`<li><strong>${e.toUpperCase()}:</strong> ${i}</li>`).join("")}
    </ul>
      </div >
  `:""}attachEvents(t){const e=document.getElementById("question-panel"),i=e.querySelectorAll(".option-btn"),s=e.querySelector("#feedback-area");i.forEach(a=>{a.addEventListener("click",()=>{this.disableAllButtons();const o=t.options.find(n=>n.id===a.dataset.id);if(o&&o.correct)a.classList.add("correct"),this.handleSuccess(s,t.successMessage);else{a.classList.add("wrong");const n=Array.from(i).find(c=>{const r=t.options.find(l=>l.id===c.dataset.id);return r&&r.correct});n&&n.classList.add("correct"),this.mistakes++,this.handleFail(s,t.failMessage)}})})}handleSuccess(t,e){setTimeout(()=>{document.getElementById("question-panel").classList.add("hidden"),this.score+=100,this.updateScore(),this.arcade.destroyCurrentObstacle(()=>this.nextLevel())},1500)}handleFail(t,e){setTimeout(()=>{document.getElementById("question-panel").classList.add("hidden"),this.arcade.triggerImpact()},2e3)}nextLevel(){this.currentLevelIndex++,this.currentLevelIndex>=this.currentPhase.levels.length?this.handlePhaseComplete():this.arcade.spawnObstacle()}updateScore(){document.getElementById("score-val").textContent=this.score}disableAllButtons(){document.querySelectorAll(".option-btn").forEach(t=>t.disabled=!0)}handlePhaseComplete(){const t=this.currentPhase.id+1;this.phases.find(i=>i.id===t)&&!this.unlockedPhases.includes(t)&&this.unlockedPhases.push(t),setTimeout(()=>this.showEndScreen(!0),1e3)}showEndScreen(t){this.arcade&&(this.arcade.stop(),this.arcade=null),this.createStarField();const e=t?"var(--neon-green)":"var(--neon-red)",i=t?"MISS√ÉO CUMPRIDA":"FIM DE JOGO",s=t?"SETOR LIMPO. BOM TRABALHO, CADETE.":"MISS√ÉO FALHOU. PACIENTE CR√çTICO.";this.ui.container.innerHTML=`
  < div class="end-screen" >
        <h1 style="color: ${e}; text-shadow: 4px 4px 0 #444;">${i}</h1>
        <p>${s}</p>
        <div class="final-score">PONTUA√á√ÉO<br><span style="font-size: 32px;">${this.score}</span></div>
        <button id="restart-btn" class="btn pulse">${t?"PR√ìXIMA MISS√ÉO":"TENTAR NOVAMENTE"}</button>
      </div >
  `,document.getElementById("restart-btn").addEventListener("click",()=>{this.audioManager.playSound("click"),t&&this.audioManager.playSound("victory"),this.renderStartScreen()})}createStarField(){const t=document.querySelector(".stars");t&&t.remove();const e=document.createElement("div");e.className="stars";const i=document.createElement("canvas");i.width=window.innerWidth,i.height=window.innerHeight,e.appendChild(i),document.body.insertBefore(e,document.body.firstChild),this.starCanvas=i;const s=i.getContext("2d"),a=[];for(let n=0;n<200;n++)a.push({x:Math.random()*i.width,y:Math.random()*i.height,radius:Math.random()*1.5,speed:Math.random()*.5+.1,opacity:Math.random()});const o=()=>{s.fillStyle="rgba(0,0,0,0.1)",s.fillRect(0,0,i.width,i.height),a.forEach(n=>{s.beginPath(),s.arc(n.x,n.y,n.radius,0,Math.PI*2),s.fillStyle=`rgba(255, 255, 255, ${n.opacity})`,s.fill(),n.y+=n.speed,n.y>i.height&&(n.y=0,n.x=Math.random()*i.width),n.opacity+=(Math.random()-.5)*.1,n.opacity=Math.max(.3,Math.min(1,n.opacity))}),this.starAnimationId=requestAnimationFrame(o)};o()}removeStarField(){this.starAnimationId&&(cancelAnimationFrame(this.starAnimationId),this.starAnimationId=null);const t=document.querySelector(".stars");t&&t.remove(),this.starCanvas=null}}const p=new x;p.init();
