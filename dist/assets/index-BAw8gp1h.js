(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}})();const c=[{id:1,title:"Fase 1: A Triagem",description:"Paciente J.S., 25 anos. Qual o conjunto de sintomas mais indicativo de Anemia Ferropriva?",options:[{id:"s1",text:"Palidez, Taquicardia e Fadiga",correct:!0},{id:"s2",text:"Febre, Dor abdominal e Vômito",correct:!1},{id:"s3",text:"Hipertensão, Ganho de peso e Insônia",correct:!1},{id:"s4",text:"Manchas vermelhas na pele e Dor nas juntas",correct:!1}],successMessage:"Correto! Sintomas clássicos de hipóxia tecidual.",failMessage:"Incorreto. Esses sintomas não formam a tríade clássica da anemia."},{id:2,title:"Fase 2: O Laboratório",description:"Analise: Hb 9.0 g/dL, VCM 70 fL. Qual o diagnóstico provável?",data:{hemoglobina:"9.0 g/dL (Ref: 12-16)",vcm:"70 fL (Ref: 80-100)"},options:[{id:"a1",text:"Anemia Microcítica (Provável Ferropriva)",correct:!0},{id:"a2",text:"Anemia Macrocítica (Provável B12)",correct:!1},{id:"a3",text:"Anemia Normocítica (Doença Crônica)",correct:!1},{id:"a4",text:"Valores Normais",correct:!1}],successMessage:"Exato! VCM baixo indica microcitose, comum na falta de ferro.",failMessage:"Errado. Observe o VCM abaixo do valor de referência."},{id:3,title:"Fase 3: A Despensa",description:"Qual a melhor combinação para maximizar a absorção de ferro?",options:[{id:"f1",text:"Feijão + Suco de Laranja (Vitamina C)",correct:!0},{id:"f2",text:"Bife de Fígado + Café com Leite",correct:!1},{id:"f3",text:"Espinafre + Iogurte (Cálcio)",correct:!1},{id:"f4",text:"Ovo Cozido + Chá Preto",correct:!1}],successMessage:"Perfeito! A Vitamina C transforma o ferro férrico em ferroso, melhorando a absorção.",failMessage:"Cuidado! Cálcio e taninos (café/chá) inibem a absorção do ferro."},{id:4,title:"Fase 4: A Prescrição",description:"Qual a conduta terapêutica padrão para Anemia Ferropriva moderada?",options:[{id:"p1",text:"Sulfato Ferroso oral + Orientação Dietética",correct:!0},{id:"p2",text:"Apenas aumentar consumo de carne",correct:!1},{id:"p3",text:"Transfusão sanguínea imediata",correct:!1},{id:"p4",text:"Antibióticos e Repouso",correct:!1}],successMessage:"Correto! A reposição oral é o tratamento de escolha.",failMessage:"Inadequado. Apenas dieta não repõe estoques e transfusão é para casos graves."}];class l{constructor(t,e,i){this.canvas=document.getElementById(t),this.ctx=this.canvas.getContext("2d"),this.onObstacleEncountered=e,this.onGameOver=i,this.width=window.innerWidth,this.height=window.innerHeight,this.canvas.width=this.width,this.canvas.height=this.height,this.ship={x:100,y:this.height/2,size:30,speed:5,visible:!0},this.asteroids=[],this.stars=[],this.lasers=[],this.particles=[],this.gameActive=!1,this.isPaused=!1,this.lastTime=0,this.spawnTimer=0,this.obstaclePending=!1,this.initStars(),window.addEventListener("resize",()=>this.resize())}resize(){this.width=window.innerWidth,this.height=window.innerHeight,this.canvas.width=this.width,this.canvas.height=this.height,this.initStars()}initStars(){this.stars=[];for(let t=0;t<100;t++)this.stars.push({x:Math.random()*this.width,y:Math.random()*this.height,size:Math.random()*2,speed:Math.random()*3+.5})}start(){this.gameActive=!0,this.isPaused=!1,this.obstaclePending=!1,this.asteroids=[],this.lasers=[],this.particles=[],this.ship.visible=!0,this.lastTime=performance.now(),this.loop(this.lastTime)}spawnObstacle(){this.obstaclePending||(this.asteroids.push({x:this.width+50,y:this.height/2,size:60,hp:1,active:!0}),this.obstaclePending=!0)}shoot(){this.isPaused=!1,this.lasers.push({x:this.ship.x+this.ship.size,y:this.ship.y,speed:15,active:!0}),this.createExplosion(this.ship.x+this.ship.size,this.ship.y,"#00ffff",5)}triggerImpact(){this.isPaused=!1,this.obstaclePending=!1}destroyShip(){this.gameActive&&(this.isPaused=!1,this.createExplosion(this.ship.x,this.ship.y,"#ff0000",50),this.ship.visible=!1,this.gameActive=!1,setTimeout(()=>{this.onGameOver&&this.onGameOver()},2e3))}createExplosion(t,e,i,s){for(let a=0;a<s;a++)this.particles.push({x:t,y:e,vx:(Math.random()-.5)*10,vy:(Math.random()-.5)*10,life:1,color:i})}update(t){this.isPaused||(this.stars.forEach(e=>{e.x-=e.speed,e.x<0&&(e.x=this.width)}),this.asteroids.forEach(e=>{if(e.active&&(e.x-=5,e.x<this.width-300&&this.obstaclePending&&(this.isPaused=!0,this.obstaclePending=!1,this.onObstacleEncountered()),this.ship.visible)){const i=e.x-this.ship.x,s=e.y-this.ship.y;Math.sqrt(i*i+s*s)<(e.size+this.ship.size)*.8&&this.destroyShip()}}),this.lasers.forEach(e=>{e.x+=e.speed,e.x>this.width&&(e.active=!1),this.asteroids.forEach(i=>{if(i.active&&e.active){const s=e.x-i.x,a=e.y-i.y;Math.sqrt(s*s+a*a)<i.size&&(i.active=!1,e.active=!1,this.createExplosion(i.x,i.y,"#ffaa00",15),this.obstaclePending=!1,this.isPaused=!1)}})}),this.particles.forEach(e=>{e.x+=e.vx,e.y+=e.vy,e.life-=.05}),this.particles=this.particles.filter(e=>e.life>0))}draw(){this.ctx.fillStyle="#000000",this.ctx.fillRect(0,0,this.width,this.height),this.ctx.fillStyle="#ffffff",this.stars.forEach(t=>{this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.size,0,Math.PI*2),this.ctx.fill()}),this.ship.visible&&(this.ctx.save(),this.ctx.translate(this.ship.x,this.ship.y),this.ctx.fillStyle="#00ff00",this.ctx.beginPath(),this.ctx.moveTo(20,0),this.ctx.lineTo(-15,10),this.ctx.lineTo(-15,-10),this.ctx.fill(),this.ctx.fillStyle=`rgba(0, 255, 255, ${Math.random()})`,this.ctx.beginPath(),this.ctx.moveTo(-15,0),this.ctx.lineTo(-30,5),this.ctx.lineTo(-30,-5),this.ctx.fill(),this.ctx.restore()),this.asteroids.forEach(t=>{t.active&&(this.ctx.fillStyle="#888888",this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.size,0,Math.PI*2),this.ctx.fill(),this.ctx.fillStyle="#666666",this.ctx.beginPath(),this.ctx.arc(t.x-10,t.y-10,t.size/3,0,Math.PI*2),this.ctx.fill())}),this.ctx.fillStyle="#00ffff",this.lasers.forEach(t=>{t.active&&this.ctx.fillRect(t.x,t.y-2,20,4)}),this.particles.forEach(t=>{this.ctx.fillStyle=t.color,this.ctx.globalAlpha=t.life,this.ctx.beginPath(),this.ctx.arc(t.x,t.y,3,0,Math.PI*2),this.ctx.fill(),this.ctx.globalAlpha=1})}loop(t){const e=t-this.lastTime;this.lastTime=t,this.update(e),this.draw(),(this.gameActive||this.particles.length>0)&&requestAnimationFrame(i=>this.loop(i))}resume(){this.isPaused=!1,this.lastTime=performance.now()}}class f{constructor(){this.currentLevelIndex=0,this.score=0,this.mistakes=0,this.gameActive=!1,this.ui={app:document.getElementById("app"),container:document.getElementById("game-container"),loading:document.getElementById("loading-screen"),hud:document.getElementById("hud"),questionPanel:document.getElementById("question-panel")},this.arcade=null}init(){setTimeout(()=>{this.ui.loading.classList.add("hidden"),this.renderStartScreen()},1500)}renderStartScreen(){this.ui.container.innerHTML=`
      <div class="start-screen">
        <h1 class="glitch" data-text="PROTOCOLO VERMELHO">PROTOCOLO VERMELHO</h1>
        <p class="subtitle">ARCADE EDITION</p>
        <div class="instructions">
          <p>PILOTE A NAVE "HEMO-1"</p>
          <p>RESPONDA CORRETAMENTE PARA DESTRUIR OS OBSTÁCULOS</p>
          <p>RESPOSTAS ERRADAS DANIFICAM A INTEGRIDADE DA NAVE</p>
        </div>
        <button id="start-btn" class="btn pulse">INICIAR MISSÃO</button>
      </div>
    `,document.getElementById("start-btn").addEventListener("click",()=>{this.startGame()})}startGame(){this.currentLevelIndex=0,this.score=0,this.mistakes=0,this.gameActive=!0,this.ui.container.innerHTML=`
      <canvas id="game-canvas"></canvas>
      <div id="hud" class="hud">
        <div class="score">SCORE: <span id="score-val">0</span></div>
      </div>
      <div id="question-panel" class="question-panel hidden">
        <!-- Question injected here -->
      </div>
    `,this.arcade=new l("game-canvas",()=>this.showQuestion(),()=>this.showEndScreen(!1)),this.arcade.start(),setTimeout(()=>this.arcade.spawnObstacle(),2e3)}showQuestion(){const t=c[this.currentLevelIndex];if(!t){this.showEndScreen(!0);return}const e=document.getElementById("question-panel");e.innerHTML=`
      <div class="panel-content">
        <h2>ALERTA DE COLISÃO!</h2>
        <p class="description">${t.description}</p>
        ${this.renderLevelData(t)}
        <div class="options-grid">
          ${t.options.map(i=>`
            <button class="option-btn" data-id="${i.id}">${i.text}</button>
          `).join("")}
        </div>
        <div id="feedback-area" class="hidden"></div>
      </div>
    `,e.classList.remove("hidden"),this.attachEvents(t)}renderLevelData(t){return t.data?`
        <div class="data-panel">
          <ul>
            ${Object.entries(t.data).map(([e,i])=>`<li><strong>${e.toUpperCase()}:</strong> ${i}</li>`).join("")}
          </ul>
        </div>
      `:""}attachEvents(t){const e=document.getElementById("question-panel"),i=e.querySelectorAll(".option-btn"),s=e.querySelector("#feedback-area");i.forEach(a=>{a.addEventListener("click",()=>{this.disableAllButtons();const o=a.dataset.id;if(t.options.find(r=>r.id===o).correct)a.classList.add("correct"),this.handleSuccess(s,t.successMessage);else{a.classList.add("wrong");const r=Array.from(i).find(h=>t.options.find(d=>d.id===h.dataset.id).correct);r&&r.classList.add("correct"),this.mistakes++,this.handleFail(s,t.failMessage)}})})}handleSuccess(t,e){document.getElementById("question-panel").classList.add("hidden"),this.arcade.shoot(),this.score+=100,this.updateScore(),setTimeout(()=>{this.nextLevel()},500)}handleFail(t,e){document.getElementById("question-panel").classList.add("hidden"),this.arcade.triggerImpact()}nextLevel(){this.currentLevelIndex++,this.currentLevelIndex>=c.length?setTimeout(()=>this.showEndScreen(!0),1e3):this.arcade.spawnObstacle()}updateScore(){document.getElementById("score-val").textContent=this.score}disableAllButtons(){document.querySelectorAll(".option-btn").forEach(e=>e.disabled=!0)}showEndScreen(t){this.ui.container.innerHTML=`
      <div class="end-screen">
        <h1>${t?"MISSÃO CUMPRIDA!":"FALHA NO PROTOCOLO"}</h1>
        <p>${t?"Você salvou a paciente e demonstrou excelente conhecimento em nutrição clínica.":"A paciente não recebeu o tratamento adequado a tempo."}</p>
        <div class="final-score">Score Final: ${this.score}</div>
        <button id="restart-btn" class="btn">Reiniciar Protocolo</button>
      </div>
    `,document.getElementById("restart-btn").addEventListener("click",()=>{this.startGame()})}}const u=new f;u.init();
